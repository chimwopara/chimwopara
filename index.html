<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chim Wopara University</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        chim: {
                            dark: "#1B2330",
                            light: "#B7D1E1",
                            deep: "#3f5268",
                            border: "rgba(183, 209, 225, 0.2)",
                        },
                        brand: {
                            primary: "#3f5268",
                            accent: "#B7D1E1",
                        },
                        demo: {
                            bg: "#151b26",
                            panel: "#1e2736",
                            accent: "#B7D1E1",
                            success: "#34d399"
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'Plus Jakarta Sans', 'sans-serif'],
                        display: ['Inter', 'Outfit', 'sans-serif'],
                        mono: ['Fira Code', 'monospace'],
                    },
                    animation: {
                        'float': 'float 8s ease-in-out infinite',
                        'blob': 'blob 15s infinite',
                        'fade-in': 'fadeIn 0.5s ease-out forwards',
                        'pop': 'pop 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)',
                        'wiggle': 'wiggle 1s ease-in-out infinite',
                        'pulse-slow': 'pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'shockwave': 'shockwave 0.5s ease-out',
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-20px)' },
                        },
                        blob: {
                            '0%': { transform: 'translate(0px, 0px) scale(1)' },
                            '33%': { transform: 'translate(30px, -50px) scale(1.1)' },
                            '66%': { transform: 'translate(-20px, 20px) scale(0.9)' },
                            '100%': { transform: 'translate(0px, 0px) scale(1)' },
                        },
                        fadeIn: {
                            '0%': { opacity: '0', transform: 'translateY(20px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        },
                        pop: {
                            '0%': { transform: 'scale(0.9)' },
                            '100%': { transform: 'scale(1)' },
                        },
                        wiggle: {
                            '0%, 100%': { transform: 'rotate(-3deg)' },
                            '50%': { transform: 'rotate(3deg)' },
                        },
                        shockwave: {
                            '0%': { transform: 'scale(1)', boxShadow: '0 0 0 0 rgba(183, 209, 225, 0.7)' },
                            '70%': { transform: 'scale(1.05)', boxShadow: '0 0 0 20px rgba(183, 209, 225, 0)' },
                            '100%': { transform: 'scale(1)', boxShadow: '0 0 0 0 rgba(183, 209, 225, 0)' }
                        }
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500&display=swap');

        body {
            background-color: #1B2330;
            color: #B7D1E1;
            overflow-x: hidden;
            font-family: 'Inter', sans-serif;
        }

        h1, h2, h3, h4, h5 {
            font-family: 'Inter', sans-serif;
        }

        .glass-panel {
            background: rgba(27, 35, 48, 0.85);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border-bottom: 1px solid rgba(183, 209, 225, 0.1);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.3);
        }
        
        .glass-card {
            background: rgba(63, 82, 104, 0.35);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(183, 209, 225, 0.2);
            transition: all 0.3s ease;
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.2);
        }

        .glass-card:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
            border-color: rgba(183, 209, 225, 0.4);
            background: rgba(63, 82, 104, 0.5);
        }

        .glass-card.mastered {
            background: rgba(63, 82, 104, 0.6);
            border-color: #B7D1E1;
            box-shadow: 0 0 20px rgba(183, 209, 225, 0.2);
        }

        .dark-glass {
            background: rgba(30, 41, 59, 0.4);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(183, 209, 225, 0.1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        }

        .chip-btn {
            background: rgba(183, 209, 225, 0.05);
            border: 1px solid rgba(183, 209, 225, 0.1);
            transition: all 0.2s ease;
            color: #B7D1E1;
        }
        
        .chip-btn:hover {
            background: rgba(183, 209, 225, 0.1);
            border-color: rgba(183, 209, 225, 0.3);
            transform: translateY(-2px);
        }

        .chip-btn:active {
            transform: scale(0.95);
        }

        .chip-btn.active {
            background: rgba(63, 82, 104, 0.8);
            border-color: #B7D1E1;
            color: #fff;
            transform: scale(0.98);
            box-shadow: 0 0 10px rgba(183, 209, 225, 0.1);
        }

        .color-swatch {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid transparent;
            transition: transform 0.2s;
        }
        .color-swatch:hover {
            transform: scale(1.2);
        }
        .color-swatch.active {
            border-color: #B7D1E1;
            box-shadow: 0 0 8px rgba(183, 209, 225, 0.5);
        }

        .text-gradient {
            background: linear-gradient(135deg, #B7D1E1, #ffffff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .bg-blob {
            position: absolute;
            filter: blur(80px);
            opacity: 0.4;
            z-index: -1;
            animation: blob 20s infinite;
        }

        .reveal-on-scroll {
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.8s cubic-bezier(0.5, 0, 0, 1);
        }
        .reveal-on-scroll.is-visible {
            opacity: 1;
            transform: translateY(0);
        }

        .nav-link {
            position: relative;
            color: #B7D1E1;
            opacity: 0.8;
        }
        .nav-link:hover {
            opacity: 1;
        }
        .nav-link::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: -4px;
            left: 0;
            background-color: #B7D1E1;
            transition: width 0.3s ease;
        }
        .nav-link:hover::after {
            width: 100%;
        }

        .tilt-card {
            transform-style: preserve-3d;
            perspective: 1000px;
        }

        .custom-scroll::-webkit-scrollbar {
            width: 6px;
        }
        .custom-scroll::-webkit-scrollbar-track {
            background: rgba(27, 35, 48, 0.5);
            border-radius: 3px;
        }
        .custom-scroll::-webkit-scrollbar-thumb {
            background: rgba(63, 82, 104, 0.8);
            border-radius: 3px;
        }
        .custom-scroll::-webkit-scrollbar-thumb:hover {
            background: rgba(183, 209, 225, 0.5);
        }

        .virtual-scrollbar::-webkit-scrollbar {
            width: 8px;
        }
        .virtual-scrollbar::-webkit-scrollbar-track {
            background: #f1f5f9;
        }
        .virtual-scrollbar::-webkit-scrollbar-thumb {
            background-color: #cbd5e1;
            border-radius: 4px;
            border: 2px solid #f1f5f9;
        }
        .virtual-scrollbar::-webkit-scrollbar-thumb:hover {
            background-color: #94a3b8;
        }

        .particle {
            position: absolute;
            width: 8px;
            height: 8px;
            pointer-events: none;
            animation: particle-explode 1s forwards;
        }
        @keyframes particle-explode {
            0% { transform: translate(0, 0) rotate(0deg); opacity: 1; }
            100% { transform: translate(var(--tx), var(--ty)) rotate(720deg); opacity: 0; }
        }

        /* Fixed height virtual screen container */
        .virtual-window-container {
            height: 520px;
            min-height: 520px;
            max-height: 520px;
        }

        /* Action chip categories */
        .chip-category {
            font-size: 9px;
            letter-spacing: 0.1em;
            color: rgba(183, 209, 225, 0.4);
            text-transform: uppercase;
            margin-bottom: 6px;
            margin-top: 12px;
            padding-left: 2px;
        }
        .chip-category:first-child {
            margin-top: 0;
        }

        /* Office Demo Styles */
        .office-tab {
            background: rgba(183, 209, 225, 0.05);
            border: 1px solid rgba(183, 209, 225, 0.1);
            color: rgba(183, 209, 225, 0.5);
        }
        .office-tab:hover {
            background: rgba(183, 209, 225, 0.1);
            color: rgba(183, 209, 225, 0.8);
        }
        .office-tab.active {
            background: rgba(63, 82, 104, 0.8);
            border-color: #B7D1E1;
            color: #fff;
        }
        #tab-word.active { background: linear-gradient(135deg, #2B579A, #3f5268); border-color: #5BA4E6; }
        #tab-excel.active { background: linear-gradient(135deg, #217346, #2d5a3f); border-color: #33C481; }
        #tab-powerpoint.active { background: linear-gradient(135deg, #B7472A, #8b3a2a); border-color: #FF8F6B; }

        .office-demo {
            display: none;
        }
        .office-demo.active {
            display: block;
            animation: fadeIn 0.3s ease-out;
        }

        .office-action-btn {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 11px;
            font-weight: 600;
            background: rgba(183, 209, 225, 0.08);
            border: 1px solid rgba(183, 209, 225, 0.15);
            color: rgba(183, 209, 225, 0.7);
            transition: all 0.2s ease;
            cursor: pointer;
        }
        .office-action-btn:hover {
            background: rgba(183, 209, 225, 0.15);
            border-color: rgba(183, 209, 225, 0.3);
            color: #fff;
            transform: translateY(-2px);
        }
        .office-action-btn:active {
            transform: scale(0.95);
        }
        .office-action-btn.triggered {
            background: rgba(52, 211, 153, 0.2);
            border-color: rgba(52, 211, 153, 0.5);
            color: #34d399;
        }

        /* Mini chart animation */
        .mini-bar {
            transition: height 0.5s ease-out;
        }

        /* Slide generation animation */
        .slide-appear {
            animation: slideAppear 0.4s ease-out forwards;
        }
        @keyframes slideAppear {
            0% { opacity: 0; transform: scale(0.8); }
            100% { opacity: 1; transform: scale(1); }
        }

        /* Website theme colors for Office apps */
        body.theme-excel {
            background-color: #142820 !important;
        }
        body.theme-excel .glass-panel {
            background: rgba(20, 50, 35, 0.85) !important;
            border-color: rgba(52, 211, 153, 0.2) !important;
        }
        body.theme-excel .glass-card {
            background: rgba(33, 115, 70, 0.25) !important;
            border-color: rgba(52, 211, 153, 0.3) !important;
        }
        body.theme-excel .dark-glass {
            background: rgba(20, 50, 35, 0.5) !important;
            border-color: rgba(52, 211, 153, 0.2) !important;
        }
        body.theme-excel .text-gradient {
            background: linear-gradient(135deg, #34d399, #ffffff) !important;
            -webkit-background-clip: text !important;
        }

        body.theme-powerpoint {
            background-color: #2a1810 !important;
        }
        body.theme-powerpoint .glass-panel {
            background: rgba(50, 25, 20, 0.85) !important;
            border-color: rgba(251, 146, 60, 0.2) !important;
        }
        body.theme-powerpoint .glass-card {
            background: rgba(183, 71, 42, 0.25) !important;
            border-color: rgba(251, 146, 60, 0.3) !important;
        }
        body.theme-powerpoint .dark-glass {
            background: rgba(50, 25, 20, 0.5) !important;
            border-color: rgba(251, 146, 60, 0.2) !important;
        }
        body.theme-powerpoint .text-gradient {
            background: linear-gradient(135deg, #fb923c, #ffffff) !important;
            -webkit-background-clip: text !important;
        }

        /* Smooth transitions for theme changes */
        body, .glass-panel, .glass-card, .dark-glass {
            transition: background-color 0.5s ease, background 0.5s ease, border-color 0.5s ease;
        }
    </style>
</head>
<body class="antialiased selection:bg-chim-deep selection:text-white">

    <!-- Background Blobs -->
    <div class="fixed top-0 left-0 w-full h-full overflow-hidden -z-10 pointer-events-none">
        <div class="bg-blob w-[500px] h-[500px] rounded-full top-[-100px] left-[-100px]" style="background: radial-gradient(circle, rgba(63, 82, 104, 0.4) 0%, transparent 70%);"></div>
        <div class="bg-blob w-[600px] h-[600px] rounded-full top-[30%] right-[-200px] animation-delay-2000" style="background: radial-gradient(circle, rgba(40, 55, 75, 0.5) 0%, transparent 70%);"></div>
        <div class="bg-blob w-[400px] h-[400px] rounded-full bottom-[-50px] left-[20%] animation-delay-4000" style="background: radial-gradient(circle, rgba(63, 82, 104, 0.3) 0%, transparent 70%);"></div>
    </div>

    <!-- Navigation -->
    <nav class="fixed top-0 w-full z-50 glass-panel transition-all duration-300" id="navbar">
        <div class="max-w-6xl mx-auto px-6 h-20 flex items-center justify-between">
            <div class="flex items-center gap-3 hover:scale-105 transition-transform cursor-pointer">
                <img src="logo.png" alt="Chim Wopara University Logo" class="w-10 h-10 rounded-xl object-contain shadow-lg shadow-black/20 bg-white/5 border border-chim-border">
                <span class="font-bold text-xl tracking-tight text-chim-light">Chim Wopara University</span>
            </div>
            <div class="hidden md:flex items-center gap-8 text-sm font-medium text-chim-light/80">
                <a href="#how-it-works" class="nav-link transition-colors">How it Works</a>
                <a href="#demo" class="nav-link transition-colors">Experience It</a>
                <a href="https://forms.fillout.com/t/35bB73fVpSus" target="_blank" class="px-5 py-2.5 rounded-full bg-chim-deep text-white hover:bg-opacity-80 hover:shadow-lg hover:-translate-y-0.5 active:scale-95 transition-all duration-300 border border-chim-border">Start Learning</a>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <header class="relative min-h-screen flex items-center pt-20 overflow-hidden">
        <div class="max-w-6xl mx-auto px-6 grid lg:grid-cols-2 gap-16 items-center">
            <div class="space-y-8 animate-float" style="animation-duration: 10s;">
                <!-- Interactive Badge -->
                <div id="no-code-badge" onclick="triggerShockwave(this)" class="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-chim-deep/30 text-chim-light text-xs font-bold uppercase tracking-wide border border-chim-border hover:bg-chim-deep/50 transition-colors cursor-pointer select-none active:scale-95">
                    <span class="w-2 h-2 rounded-full bg-blue-400 animate-pulse"></span>
                    <span id="badge-text">For Busy Professionals</span>
                </div>

                <h1 class="text-5xl md:text-7xl font-bold leading-[1.1] text-chim-light group cursor-default">
                    Master AI.<br>
                    <span class="text-gradient">Work smarter.</span>
                </h1>
                <p class="text-xl text-chim-light/70 leading-relaxed max-w-lg reveal-on-scroll">
                    Learn AI for Word, Excel, PowerPoint, Websites and more. 52 weeks. One topic every two weeks. Keep pace without quitting your job.
                </p>
                <div class="flex flex-col sm:flex-row gap-4 reveal-on-scroll" style="transition-delay: 100ms;">
                    <a href="#demo" class="px-8 py-4 rounded-xl bg-chim-deep text-white font-bold shadow-lg shadow-black/20 hover:shadow-black/40 hover:-translate-y-1 active:scale-95 transition-all text-center border border-chim-border/50">
                        Try the Simulator
                    </a>
                    <a href="https://forms.fillout.com/t/35bB73fVpSus" target="_blank" class="px-8 py-4 rounded-xl bg-transparent text-chim-light font-bold border border-chim-border hover:bg-chim-deep/20 hover:border-chim-light/50 active:scale-95 transition-all flex items-center justify-center gap-2 group">
                        <i class="fa-solid fa-graduation-cap text-chim-light group-hover:scale-110 transition-transform"></i> Enroll Now
                    </a>
                </div>
                
                <div class="flex items-center gap-4 text-sm text-chim-light/60 pt-4 reveal-on-scroll" style="transition-delay: 200ms;">
                    <div class="flex -space-x-3 hover:space-x-0 transition-all duration-500">
                        <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Felix" class="w-10 h-10 rounded-full border-2 border-chim-dark bg-chim-deep shadow-sm hover:scale-125 transition-transform z-10">
                        <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Aneka" class="w-10 h-10 rounded-full border-2 border-chim-dark bg-chim-deep shadow-sm hover:scale-125 transition-transform z-10">
                        <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=John" class="w-10 h-10 rounded-full border-2 border-chim-dark bg-chim-deep shadow-sm hover:scale-125 transition-transform z-10">
                    </div>
                    <p>2,500+ professionals learning</p>
                </div>
            </div>

            <!-- Hero Visual: Interactive Office AI Demo -->
            <div class="relative hidden lg:block perspective-1000">
                <!-- Main Card with Office Demo -->
                <div id="hero-card" class="glass-card rounded-3xl p-6 transform transition-transform duration-100 shadow-2xl relative z-10 tilt-card overflow-hidden">
                    
                    <!-- Instruction hint -->
                    <div class="text-center mb-3">
                        <span class="text-xs text-chim-light/50 bg-chim-deep/30 px-3 py-1 rounded-full border border-chim-border/50">
                            <i class="fa-solid fa-hand-pointer mr-1"></i> Click the tabs & buttons below to explore
                        </span>
                    </div>
                    
                    <!-- App Tabs -->
                    <div class="flex gap-2 mb-5">
                        <button onclick="switchOfficeApp('word')" id="tab-word" class="office-tab active flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-bold transition-all cursor-pointer hover:scale-105">
                            <svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor"><path d="M23.004 1.5q.41 0 .703.293t.293.703v19.008q0 .41-.293.703t-.703.293H6.996q-.41 0-.703-.293T6 21.504V18H.996q-.41 0-.703-.293T0 17.004V6.996q0-.41.293-.703T.996 6H6V2.496q0-.41.293-.703t.703-.293zM6.035 11.203l1.442 4.735h1.64l1.57-7.876H9.036l-.937 4.653-1.325-4.5H5.38l-1.406 4.523-.938-4.675H1.312l1.57 7.874h1.641zM22.5 21v-3h-15v3zm0-4.5v-3.75h-12v3.75zm0-5.25V7.5h-12v3.75zm0-5.25V3h-15v3z"/></svg>
                            Word
                        </button>
                        <button onclick="switchOfficeApp('excel')" id="tab-excel" class="office-tab flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-bold transition-all cursor-pointer hover:scale-105">
                            <svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor"><path d="M23 1.5q.41 0 .7.3.3.29.3.7v19q0 .41-.3.7-.29.3-.7.3H7q-.41 0-.7-.3-.3-.29-.3-.7V18H1q-.41 0-.7-.3-.3-.29-.3-.7V7q0-.41.3-.7.29-.3.7-.3h5V2.5q0-.41.3-.7.29-.3.7-.3zM6 13.28l1.42 2.66h2.14l-2.38-3.87 2.34-3.8H7.46l-1.3 2.4-.05.08-.04.09-.64-1.28-.66-1.29H2.59l2.27 3.82-2.48 3.85h2.16zM14.25 21v-3H7.5v3zm0-4.5v-3.75H7.5v3.75zm0-5.25V7.5H7.5v3.75zm8.25 9.75v-3h-6.75v3zm0-4.5v-3.75h-6.75v3.75zm0-5.25V7.5h-6.75v3.75zm0-5.25V3H7.5v3z"/></svg>
                            Excel
                        </button>
                        <button onclick="switchOfficeApp('powerpoint')" id="tab-powerpoint" class="office-tab flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-bold transition-all cursor-pointer hover:scale-105">
                            <svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor"><path d="M23.004 1.5q.41 0 .703.293t.293.703v19.008q0 .41-.293.703t-.703.293H6.996q-.41 0-.703-.293T6 21.504V18H.996q-.41 0-.703-.293T0 17.004V6.996q0-.41.293-.703T.996 6H6V2.496q0-.41.293-.703t.703-.293zM9.14 8.089q-.703 0-1.266.117t-.96.293v7.03h1.523v-2.46h.773q.681 0 1.207-.182t.879-.503.527-.761.175-.973q0-1.148-.726-1.852-.727-.709-2.133-.709zm.07 1.195q.54 0 .841.282.305.281.305.773 0 .516-.305.791-.3.27-.852.27h-.656v-2.116zM22.5 21v-3h-15v3zm0-4.5V12h-15v4.5zM22.5 10.5V6h-15v4.5z"/></svg>
                            PPT
                        </button>
                    </div>

                    <!-- Demo Screen -->
                    <div id="office-demo-screen" class="bg-chim-dark/60 rounded-xl p-4 min-h-[280px] border border-chim-border relative overflow-hidden transition-all duration-500">
                        
                        <!-- Word Demo -->
                        <div id="demo-word" class="office-demo active">
                            <div class="flex items-center gap-2 mb-3 text-xs text-chim-light/50">
                                <div class="w-2 h-2 rounded-full bg-blue-400 animate-pulse"></div>
                                <span class="font-mono">AI Assistant Ready</span>
                            </div>
                            <div id="word-content" class="space-y-3">
                                <div class="p-3 bg-white/5 rounded-lg border border-chim-border/50">
                                    <div class="text-xs text-chim-light/40 mb-1">Your notes:</div>
                                    <div class="text-sm text-chim-light/70 italic">"Q3 sales up 23%, new product launch successful, team expanded to 12..."</div>
                                </div>
                                <div id="word-output" class="hidden">
                                    <div class="text-xs text-green-400 mb-2 flex items-center gap-1">
                                        <i class="fa-solid fa-sparkles"></i> Generated Report
                                    </div>
                                    <div class="p-3 bg-white/10 rounded-lg border border-green-500/30 text-sm text-chim-light space-y-2">
                                        <div class="font-bold">Q3 Performance Summary</div>
                                        <div class="text-chim-light/70 text-xs">Revenue increased 23% YoY driven by successful product launch. Team capacity expanded to support growth...</div>
                                    </div>
                                </div>
                            </div>
                            <div class="mt-4">
                                <div class="text-[10px] text-chim-light/40 mb-2 uppercase tracking-wider">Click an action:</div>
                                <div class="flex flex-wrap gap-2">
                                    <button onclick="triggerWordAction('report')" class="office-action-btn" data-action="report">
                                        <i class="fa-solid fa-file-lines"></i> Generate Report
                                    </button>
                                    <button onclick="triggerWordAction('summarize')" class="office-action-btn" data-action="summarize">
                                        <i class="fa-solid fa-compress"></i> Summarize
                                    </button>
                                    <button onclick="triggerWordAction('rewrite')" class="office-action-btn" data-action="rewrite">
                                        <i class="fa-solid fa-pen"></i> Rewrite Formal
                                    </button>
                                    <button onclick="triggerWordAction('translate')" class="office-action-btn" data-action="translate">
                                        <i class="fa-solid fa-language"></i> Translate
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Excel Demo -->
                        <div id="demo-excel" class="office-demo hidden">
                            <div class="flex items-center gap-2 mb-3 text-xs text-chim-light/50">
                                <div class="w-2 h-2 rounded-full bg-emerald-400 animate-pulse"></div>
                                <span class="font-mono">AI Assistant Ready</span>
                            </div>
                            <div id="excel-content">
                                <!-- Mini spreadsheet -->
                                <div class="bg-white/5 rounded-lg border border-chim-border/50 overflow-hidden text-xs">
                                    <div class="grid grid-cols-4 gap-px bg-chim-border/30">
                                        <div class="bg-chim-deep/50 p-2 font-bold text-chim-light/60">Month</div>
                                        <div class="bg-chim-deep/50 p-2 font-bold text-chim-light/60">Sales</div>
                                        <div class="bg-chim-deep/50 p-2 font-bold text-chim-light/60">Costs</div>
                                        <div class="bg-chim-deep/50 p-2 font-bold text-chim-light/60" id="excel-header-4">Profit</div>
                                    </div>
                                    <div class="grid grid-cols-4 gap-px bg-chim-border/30">
                                        <div class="bg-chim-dark/50 p-2 text-chim-light/70">Jan</div>
                                        <div class="bg-chim-dark/50 p-2 text-chim-light/70">$12,400</div>
                                        <div class="bg-chim-dark/50 p-2 text-chim-light/70">$8,200</div>
                                        <div class="bg-chim-dark/50 p-2 text-chim-light/70" id="excel-cell-4">$4,200</div>
                                    </div>
                                    <div class="grid grid-cols-4 gap-px bg-chim-border/30">
                                        <div class="bg-chim-dark/50 p-2 text-chim-light/70">Feb</div>
                                        <div class="bg-chim-dark/50 p-2 text-chim-light/70">$15,800</div>
                                        <div class="bg-chim-dark/50 p-2 text-chim-light/70">$9,100</div>
                                        <div class="bg-chim-dark/50 p-2 text-chim-light/70" id="excel-cell-5">$6,700</div>
                                    </div>
                                    <div class="grid grid-cols-4 gap-px bg-chim-border/30">
                                        <div class="bg-chim-dark/50 p-2 text-chim-light/70">Mar</div>
                                        <div class="bg-chim-dark/50 p-2 text-chim-light/70">$18,200</div>
                                        <div class="bg-chim-dark/50 p-2 text-chim-light/70">$10,400</div>
                                        <div class="bg-chim-dark/50 p-2 text-chim-light/70" id="excel-cell-6">$7,800</div>
                                    </div>
                                </div>
                                <div id="excel-output" class="hidden mt-3">
                                    <div class="text-xs text-green-400 mb-2 flex items-center gap-1">
                                        <i class="fa-solid fa-sparkles"></i> <span id="excel-output-label">Analysis Complete</span>
                                    </div>
                                    <div id="excel-output-content" class="p-3 bg-white/10 rounded-lg border border-green-500/30 text-sm text-chim-light">
                                    </div>
                                </div>
                            </div>
                            <div class="mt-4">
                                <div class="text-[10px] text-chim-light/40 mb-2 uppercase tracking-wider">Click an action:</div>
                                <div class="flex flex-wrap gap-2">
                                    <button onclick="triggerExcelAction('formula')" class="office-action-btn" data-action="formula">
                                        <i class="fa-solid fa-calculator"></i> Write Formula
                                    </button>
                                    <button onclick="triggerExcelAction('chart')" class="office-action-btn" data-action="chart">
                                        <i class="fa-solid fa-chart-bar"></i> Create Chart
                                    </button>
                                    <button onclick="triggerExcelAction('insight')" class="office-action-btn" data-action="insight">
                                        <i class="fa-solid fa-lightbulb"></i> Find Insights
                                    </button>
                                    <button onclick="triggerExcelAction('clean')" class="office-action-btn" data-action="clean">
                                        <i class="fa-solid fa-broom"></i> Clean Data
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- PowerPoint Demo -->
                        <div id="demo-powerpoint" class="office-demo hidden">
                            <div class="flex items-center gap-2 mb-3 text-xs text-chim-light/50">
                                <div class="w-2 h-2 rounded-full bg-orange-400 animate-pulse"></div>
                                <span class="font-mono">AI Assistant Ready</span>
                            </div>
                            <div id="ppt-content">
                                <div class="p-3 bg-white/5 rounded-lg border border-chim-border/50 mb-3">
                                    <div class="text-xs text-chim-light/40 mb-1">Your outline:</div>
                                    <div class="text-sm text-chim-light/70 italic">"Product roadmap presentation: intro, market analysis, features, timeline, Q&A"</div>
                                </div>
                                <div id="ppt-slides" class="grid grid-cols-3 gap-2">
                                    <div class="aspect-video bg-chim-deep/50 rounded border border-chim-border/50 flex items-center justify-center text-chim-light/30 text-xs">
                                        <i class="fa-solid fa-plus"></i>
                                    </div>
                                </div>
                                <div id="ppt-output" class="hidden mt-3">
                                    <div class="text-xs text-green-400 mb-2 flex items-center gap-1">
                                        <i class="fa-solid fa-sparkles"></i> <span id="ppt-output-label">Slides Generated</span>
                                    </div>
                                </div>
                            </div>
                            <div class="mt-4">
                                <div class="text-[10px] text-chim-light/40 mb-2 uppercase tracking-wider">Click an action:</div>
                                <div class="flex flex-wrap gap-2">
                                    <button onclick="triggerPptAction('generate')" class="office-action-btn" data-action="generate">
                                        <i class="fa-solid fa-wand-magic-sparkles"></i> Generate Slides
                                    </button>
                                    <button onclick="triggerPptAction('design')" class="office-action-btn" data-action="design">
                                        <i class="fa-solid fa-palette"></i> Apply Design
                                    </button>
                                    <button onclick="triggerPptAction('notes')" class="office-action-btn" data-action="notes">
                                        <i class="fa-solid fa-note-sticky"></i> Speaker Notes
                                    </button>
                                    <button onclick="triggerPptAction('image')" class="office-action-btn" data-action="image">
                                        <i class="fa-solid fa-image"></i> Add Images
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Methodology -->
    <section id="how-it-works" class="py-20 relative bg-chim-dark/50 border-t border-chim-border/50">
        <div class="max-w-6xl mx-auto px-6">
            <div class="text-center max-w-2xl mx-auto mb-16 reveal-on-scroll">
                <span class="text-chim-light/60 font-bold tracking-wider text-xs uppercase mb-2 block" id="methodology-subtitle">The Method</span>
                <h2 class="text-3xl md:text-4xl font-bold mb-4 text-chim-light">Built for your schedule</h2>
                <p class="text-chim-light/70">Tap each module to activate. (<span id="mastery-count">0</span>/3)</p>
            </div>

            <div class="grid md:grid-cols-3 gap-8">
                <div class="glass-card p-8 rounded-2xl text-center group reveal-on-scroll cursor-pointer select-none transition-all duration-300" onclick="toggleMastery(this)" data-index="1" style="transition-delay: 100ms;">
                    <div class="icon-container w-16 h-16 mx-auto bg-chim-deep/30 rounded-2xl flex items-center justify-center text-chim-light/50 text-2xl mb-6 transition-all duration-500 border border-chim-border">
                        <i class="fa-solid fa-calendar-check"></i>
                    </div>
                    <h3 class="text-xl font-bold mb-3 opacity-60 group-hover:opacity-100 transition-opacity text-chim-light">2 weeks per tool</h3>
                    <p class="text-chim-light/60 text-sm">Master Word, then Excel, then PowerPoint. One at a time.</p>
                </div>
                <div class="glass-card p-8 rounded-2xl text-center group reveal-on-scroll cursor-pointer select-none transition-all duration-300" onclick="toggleMastery(this)" data-index="2" style="transition-delay: 200ms;">
                    <div class="icon-container w-16 h-16 mx-auto bg-chim-deep/30 rounded-2xl flex items-center justify-center text-chim-light/50 text-2xl mb-6 transition-all duration-500 border border-chim-border">
                        <i class="fa-solid fa-video"></i>
                    </div>
                    <h3 class="text-xl font-bold mb-3 opacity-60 group-hover:opacity-100 transition-opacity text-chim-light">15-min lessons</h3>
                    <p class="text-chim-light/60 text-sm">Bite-sized videos. Watch during lunch or commute.</p>
                </div>
                <div class="glass-card p-8 rounded-2xl text-center group reveal-on-scroll cursor-pointer select-none transition-all duration-300" onclick="toggleMastery(this)" data-index="3" style="transition-delay: 300ms;">
                    <div class="icon-container w-16 h-16 mx-auto bg-chim-deep/30 rounded-2xl flex items-center justify-center text-chim-light/50 text-2xl mb-6 transition-all duration-500 border border-chim-border">
                        <i class="fa-solid fa-briefcase"></i>
                    </div>
                    <h3 class="text-xl font-bold mb-3 opacity-60 group-hover:opacity-100 transition-opacity text-chim-light">Use at work Monday</h3>
                    <p class="text-chim-light/60 text-sm">Every lesson has a real task you can apply immediately.</p>
                </div>
            </div>
            
            <div id="success-message" class="hidden text-center mt-12 animate-pop">
                <div class="inline-block px-6 py-3 bg-green-900/30 border border-green-500/30 text-green-400 rounded-full font-bold shadow-lg backdrop-blur-md">
                    <i class="fa-solid fa-check-circle mr-2"></i> You're ready. Let's level up.
                </div>
            </div>
        </div>
    </section>

    <!-- Tap-to-Build Simulator -->
    <section id="demo" class="py-24 relative overflow-hidden bg-chim-dark">
        <div class="absolute top-0 right-0 w-96 h-96 bg-chim-deep/20 rounded-full blur-[120px] animate-pulse-slow"></div>
        <div class="absolute bottom-0 left-0 w-96 h-96 bg-blue-900/20 rounded-full blur-[120px] animate-pulse-slow"></div>

        <div class="max-w-7xl mx-auto px-6 relative z-10">
            <div class="text-center mb-16 reveal-on-scroll">
                <span class="inline-block py-1 px-3 rounded-full bg-chim-deep/40 text-chim-light text-xs font-mono mb-4 border border-chim-border animate-pulse">SIMULATOR v2.0</span>
                <h2 class="text-4xl md:text-5xl font-bold mb-4 text-chim-light">See the <span class="text-gradient">magic</span></h2>
                <p class="text-chim-light/70 max-w-xl mx-auto">Tap to build. Toggle to destroy. This is how you'll ship.</p>
            </div>

            <div class="grid lg:grid-cols-12 gap-8 reveal-on-scroll">
                
                <!-- Left: Logic Palette -->
                <div class="lg:col-span-4 dark-glass rounded-2xl p-6 flex flex-col hover:border-chim-light/30 transition-colors duration-500 h-[680px]">
                    
                    <!-- Theme Engine -->
                    <div class="mb-4 pb-4 border-b border-chim-border">
                        <label class="text-xs font-mono text-chim-light/60 uppercase tracking-widest block mb-3">Theme Engine</label>
                        <div class="flex gap-3 justify-start">
                            <div class="color-swatch bg-blue-500 active" onclick="changeAccentColor('#3b82f6', this)"></div>
                            <div class="color-swatch bg-purple-500" onclick="changeAccentColor('#a855f7', this)"></div>
                            <div class="color-swatch bg-emerald-500" onclick="changeAccentColor('#10b981', this)"></div>
                            <div class="color-swatch bg-rose-500" onclick="changeAccentColor('#f43f5e', this)"></div>
                            <div class="color-swatch bg-amber-500" onclick="changeAccentColor('#f59e0b', this)"></div>
                            <div class="color-swatch bg-cyan-500" onclick="changeAccentColor('#06b6d4', this)"></div>
                            <div class="color-swatch bg-pink-500" onclick="changeAccentColor('#ec4899', this)"></div>
                        </div>
                    </div>

                    <div class="mb-2 flex items-center justify-between">
                        <label class="text-xs font-mono text-chim-light/60 uppercase tracking-widest">Components</label>
                        <span class="text-[10px] text-chim-light/60 bg-chim-deep/30 px-2 py-0.5 rounded border border-chim-border/50">TAP TO TOGGLE</span>
                    </div>
                    
                    <div class="flex-1 overflow-y-auto custom-scroll pr-2 -mr-2">
                        <div id="action-grid">
                            <!-- Action Chips injected by JS -->
                        </div>
                    </div>

                    <div class="mt-4 pt-4 border-t border-chim-border">
                         <div class="bg-black/30 p-3 rounded-lg border border-chim-border/50 group">
                            <div class="flex items-center gap-2 mb-2">
                                <div class="w-2 h-2 rounded-full bg-green-500 animate-pulse" id="status-light"></div>
                                <span class="text-xs text-chim-light/60 font-mono group-hover:text-green-400 transition-colors">READY</span>
                            </div>
                            <div id="status-log" class="text-xs font-mono text-purple-400 h-6 overflow-hidden truncate">Waiting for input...</div>
                         </div>
                         <button onclick="resetDemo()" class="w-full mt-3 py-2 text-xs text-chim-light/60 hover:text-chim-light transition-colors border border-dashed border-chim-border hover:border-chim-light/50 rounded active:scale-95 group">
                            <i class="fa-solid fa-rotate-right mr-1 group-hover:rotate-180 transition-transform duration-500"></i> Reset
                         </button>
                    </div>
                </div>

                <!-- Right: Virtual Mac Window -->
                <div class="lg:col-span-8 flex flex-col">
                    <div class="dark-glass rounded-t-2xl border-b border-chim-border p-4 flex items-center gap-4 select-none">
                        <div class="flex gap-2">
                            <div class="w-3 h-3 rounded-full bg-red-500/80 hover:bg-red-500 cursor-pointer hover:scale-110 transition-transform"></div>
                            <div class="w-3 h-3 rounded-full bg-yellow-500/80 hover:bg-yellow-500 cursor-pointer hover:scale-110 transition-transform"></div>
                            <div class="w-3 h-3 rounded-full bg-green-500/80 hover:bg-green-500 cursor-pointer hover:scale-110 transition-transform"></div>
                        </div>
                        <div class="flex-1 text-center">
                            <div class="inline-flex items-center gap-2 px-3 py-1 rounded-md bg-black/40 text-xs text-chim-light/60 font-mono border border-chim-border/30 w-64 justify-center group cursor-text transition-all focus-within:border-chim-light/30">
                                <i class="fa-solid fa-lock text-[10px] group-hover:text-green-500 transition-colors"></i> localhost:3000
                            </div>
                        </div>
                        <div class="w-16"></div> 
                    </div>
                    
                    <!-- Virtual Screen Container: FIXED HEIGHT with separate scroll and overlay layers -->
                    <div id="virtual-screen" class="virtual-window-container bg-white relative overflow-hidden rounded-b-2xl border-x border-b border-chim-border shadow-2xl transition-all duration-500">
                        
                        <!-- Scrollable Content Layer -->
                        <div id="scroll-container" class="absolute inset-0 overflow-y-auto virtual-scrollbar scroll-smooth">
                            <!-- Empty State -->
                            <div id="empty-state" class="absolute inset-0 flex flex-col items-center justify-center text-black pointer-events-none z-10">
                                <div class="relative">
                                    <i class="fa-solid fa-cube text-5xl mb-4 opacity-40 animate-bounce"></i>
                                    <div class="absolute -bottom-2 left-1/2 -translate-x-1/2 w-12 h-1 bg-black/20 blur-md rounded-full"></div>
                                </div>
                                <p class="font-mono text-sm opacity-80 font-bold">Canvas Empty</p>
                            </div>
                            
                            <!-- Site Container - flex column for sticky footer -->
                            <div id="site-container" class="min-h-full flex flex-col transition-all duration-300 text-gray-800">
                                <!-- Dynamic elements appear here -->
                            </div>
                        </div>
                        
                        <!-- Fixed Overlay Layer - doesn't scroll -->
                        <div id="overlay-container" class="absolute inset-0 pointer-events-none z-20">
                            <!-- Chat widgets, modals, etc. appear here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Integrated Syllabus Module -->
            <div class="mt-16 border-t border-chim-border/50 pt-16 reveal-on-scroll">
                <div class="flex items-center gap-4 mb-8">
                    <div class="w-10 h-10 rounded-lg bg-chim-deep/30 border border-chim-border flex items-center justify-center text-chim-light">
                        <i class="fa-solid fa-book-open"></i>
                    </div>
                    <h3 class="text-2xl font-bold text-chim-light">Full curriculum</h3>
                </div>

                <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-4">
                    <div class="dark-glass p-5 rounded-xl hover:border-blue-500/30 transition-colors group cursor-default">
                        <h4 class="text-blue-400 font-mono text-xs mb-3 uppercase tracking-wider">Microsoft Office</h4>
                        <ul class="space-y-3 text-sm text-chim-light/70">
                            <li class="flex items-center gap-2 group-hover:text-chim-light transition-colors"><i class="fa-solid fa-file-word text-chim-light/40"></i> Word + AI Writing</li>
                            <li class="flex items-center gap-2 group-hover:text-chim-light transition-colors"><i class="fa-solid fa-file-excel text-chim-light/40"></i> Excel + AI Analysis</li>
                            <li class="flex items-center gap-2 group-hover:text-chim-light transition-colors"><i class="fa-solid fa-file-powerpoint text-chim-light/40"></i> PowerPoint + AI Design</li>
                            <li class="flex items-center gap-2 group-hover:text-chim-light transition-colors"><i class="fa-solid fa-envelope text-chim-light/40"></i> Outlook + AI Email</li>
                        </ul>
                    </div>

                    <div class="dark-glass p-5 rounded-xl hover:border-purple-500/30 transition-colors group cursor-default">
                        <h4 class="text-purple-400 font-mono text-xs mb-3 uppercase tracking-wider">AI Assistants</h4>
                        <ul class="space-y-3 text-sm text-chim-light/70">
                            <li class="flex items-center gap-2 group-hover:text-chim-light transition-colors"><i class="fa-solid fa-robot text-chim-light/40"></i> ChatGPT Mastery</li>
                            <li class="flex items-center gap-2 group-hover:text-chim-light transition-colors"><i class="fa-solid fa-brain text-chim-light/40"></i> Claude for Work</li>
                            <li class="flex items-center gap-2 group-hover:text-chim-light transition-colors"><i class="fa-brands fa-microsoft text-chim-light/40"></i> Copilot Pro</li>
                            <li class="flex items-center gap-2 group-hover:text-chim-light transition-colors"><i class="fa-solid fa-wand-magic-sparkles text-chim-light/40"></i> Prompt Engineering</li>
                        </ul>
                    </div>

                    <div class="dark-glass p-5 rounded-xl hover:border-emerald-500/30 transition-colors group cursor-default">
                        <h4 class="text-emerald-400 font-mono text-xs mb-3 uppercase tracking-wider">Automation</h4>
                        <ul class="space-y-3 text-sm text-chim-light/70">
                            <li class="flex items-center gap-2 group-hover:text-chim-light transition-colors"><i class="fa-solid fa-bolt text-chim-light/40"></i> Zapier & Make</li>
                            <li class="flex items-center gap-2 group-hover:text-chim-light transition-colors"><i class="fa-solid fa-table text-chim-light/40"></i> Google Sheets AI</li>
                            <li class="flex items-center gap-2 group-hover:text-chim-light transition-colors"><i class="fa-solid fa-diagram-project text-chim-light/40"></i> Power Automate</li>
                            <li class="flex items-center gap-2 group-hover:text-chim-light transition-colors"><i class="fa-solid fa-code text-chim-light/40"></i> No-Code Apps</li>
                        </ul>
                    </div>

                    <div class="dark-glass p-5 rounded-xl hover:border-amber-500/30 transition-colors group cursor-default">
                        <h4 class="text-amber-400 font-mono text-xs mb-3 uppercase tracking-wider">Creative</h4>
                        <ul class="space-y-3 text-sm text-chim-light/70">
                            <li class="flex items-center gap-2 group-hover:text-chim-light transition-colors"><i class="fa-solid fa-image text-chim-light/40"></i> AI Image Gen</li>
                            <li class="flex items-center gap-2 group-hover:text-chim-light transition-colors"><i class="fa-solid fa-video text-chim-light/40"></i> AI Video Tools</li>
                            <li class="flex items-center gap-2 group-hover:text-chim-light transition-colors"><i class="fa-solid fa-microphone text-chim-light/40"></i> Voice & Transcription</li>
                            <li class="flex items-center gap-2 group-hover:text-chim-light transition-colors"><i class="fa-solid fa-file-pdf text-chim-light/40"></i> PDF Automation</li>
                        </ul>
                    </div>
                </div>
            </div>

        </div>
    </section>

    <!-- Pricing -->
    <section class="py-24 text-center border-t border-chim-border/50 bg-chim-dark">
        <div class="max-w-4xl mx-auto px-6 reveal-on-scroll">
            <h2 class="text-4xl font-bold mb-6 text-chim-light">One price. Full access.</h2>
            <div class="glass-card p-1 rounded-3xl inline-block shadow-2xl shadow-black/20 max-w-lg w-full hover:-translate-y-2 transition-transform duration-500">
                <div class="bg-chim-deep/20 rounded-[20px] p-10 backdrop-blur-md">
                    <div class="text-blue-300 font-bold tracking-widest text-sm mb-2">LIFETIME ACCESS</div>
                    <div class="text-6xl font-bold text-chim-light mb-2">$499</div>
                    <div class="text-chim-light/50 text-sm mb-6">7-day money-back guarantee</div>
                    <ul class="text-left space-y-4 mb-8 text-chim-light/80">
                        <li class="flex items-center gap-3"><i class="fa-solid fa-check text-green-400"></i> 52 weeks of content (26 topics)</li>
                        <li class="flex items-center gap-3"><i class="fa-solid fa-check text-green-400"></i> Weekly lectures, notes & challenges</li>
                        <li class="flex items-center gap-3"><i class="fa-solid fa-check text-green-400"></i> Private Discord community</li>
                        <li class="flex items-center gap-3"><i class="fa-solid fa-check text-green-400"></i> Certificate of completion ($500 value)</li>
                        <li class="flex items-center gap-3"><i class="fa-solid fa-check text-green-400"></i> Free updates forever</li>
                    </ul>
                    <a href="https://forms.fillout.com/t/35bB73fVpSus" target="_blank" class="block w-full py-4 rounded-xl bg-chim-deep text-white font-bold hover:bg-opacity-80 transition-all shadow-lg active:scale-95 border border-chim-border">
                        Enroll Now
                    </a>
                    <p class="text-xs text-chim-light/40 mt-4">
                        <i class="fa-solid fa-shield-halved mr-1"></i> Secure checkout powered by Fillout & Stripe
                    </p>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-chim-dark border-t border-chim-border py-12">
        <div class="max-w-6xl mx-auto px-6 text-center md:text-left flex flex-col md:flex-row justify-between items-center gap-6">
            <div class="flex items-center gap-2 grayscale hover:grayscale-0 transition-all duration-500 cursor-pointer">
                <img src="logo.png" alt="Chim Wopara University Logo" class="w-8 h-8 rounded-lg object-contain bg-white/5 border border-chim-border">
                <span class="font-bold text-chim-light">Chim Wopara University</span>
            </div>
            <div class="flex items-center gap-6 text-chim-light/50 text-sm">
                <a href="terms.html" class="hover:text-chim-light transition-colors">Privacy Policy</a>
                <a href="terms.html" class="hover:text-chim-light transition-colors">Terms & Conditions</a>
            </div>
            <div class="text-chim-light/50 text-sm">
                &copy; <span id="current-year"></span> Chim Wopara University. Built with logic.
            </div>
        </div>
    </footer>

    <script>
        // Auto-update year
        document.getElementById('current-year').textContent = new Date().getFullYear();
        // --- 1. Systemwide Scroll Reveal ---
        const observer = new IntersectionObserver((entries, obs) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('is-visible');
                    obs.unobserve(entry.target);
                }
            });
        }, { threshold: 0.1 });

        document.addEventListener('DOMContentLoaded', () => {
            document.querySelectorAll('.reveal-on-scroll').forEach(el => observer.observe(el));
        });

        // --- 2. 3D Tilt Effect ---
        const card = document.getElementById('hero-card');
        if (card) {
            card.addEventListener('mousemove', (e) => {
                const rect = card.getBoundingClientRect();
                const x = ((e.clientX - rect.left) / rect.width) * 2 - 1;
                const y = ((e.clientY - rect.top) / rect.height) * 2 - 1;
                card.style.transform = `perspective(1000px) rotateX(${y * -5}deg) rotateY(${x * 5}deg) scale3d(1.02, 1.02, 1.02)`;
            });
            card.addEventListener('mouseleave', () => {
                card.style.transform = 'perspective(1000px) rotateX(0) rotateY(0) scale3d(1, 1, 1)';
            });
        }

        // --- 3. Badge Shockwave ---
        function triggerShockwave(el) {
            el.classList.remove('animate-shockwave');
            void el.offsetWidth;
            el.classList.add('animate-shockwave');
            
            const texts = ["For Busy Professionals", "No Tech Background Needed", "Learn at Your Pace", "Real Skills, Real Results"];
            const span = document.getElementById('badge-text');
            const randomText = texts[Math.floor(Math.random() * texts.length)];
            span.innerText = randomText;
        }

        // --- 4. Logic Node Mini-Game ---
        let masteredCount = 0;
        let masteredIds = new Set();

        // --- OFFICE AI DEMO ---
        let currentOfficeApp = 'word';
        let officeActionStates = { word: new Set(), excel: new Set(), powerpoint: new Set() };

        function switchOfficeApp(app) {
            currentOfficeApp = app;
            
            // Update tabs
            document.querySelectorAll('.office-tab').forEach(t => t.classList.remove('active'));
            document.getElementById(`tab-${app}`).classList.add('active');
            
            // Update demos
            document.querySelectorAll('.office-demo').forEach(d => d.classList.remove('active'));
            document.getElementById(`demo-${app}`).classList.add('active');
            
            // Change website theme based on app
            const body = document.body;
            const blobs = document.querySelectorAll('.bg-blob');
            
            // Reset classes
            body.classList.remove('theme-excel', 'theme-powerpoint');
            
            if (app === 'excel') {
                body.classList.add('theme-excel');
                blobs.forEach(blob => {
                    blob.style.background = 'radial-gradient(circle, rgba(33, 115, 70, 0.5) 0%, transparent 70%)';
                });
            } else if (app === 'powerpoint') {
                body.classList.add('theme-powerpoint');
                blobs.forEach(blob => {
                    blob.style.background = 'radial-gradient(circle, rgba(183, 71, 42, 0.5) 0%, transparent 70%)';
                });
            } else {
                // Word - back to normal
                blobs[0].style.background = 'radial-gradient(circle, rgba(63, 82, 104, 0.4) 0%, transparent 70%)';
                blobs[1].style.background = 'radial-gradient(circle, rgba(40, 55, 75, 0.5) 0%, transparent 70%)';
                blobs[2].style.background = 'radial-gradient(circle, rgba(63, 82, 104, 0.3) 0%, transparent 70%)';
            }
        }

        function triggerWordAction(action) {
            const btn = document.querySelector(`.office-action-btn[data-action="${action}"]`);
            const output = document.getElementById('word-output');
            
            if (officeActionStates.word.has(action)) {
                officeActionStates.word.delete(action);
                btn.classList.remove('triggered');
                if (officeActionStates.word.size === 0) output.classList.add('hidden');
                return;
            }
            
            officeActionStates.word.add(action);
            btn.classList.add('triggered');
            output.classList.remove('hidden');
            
            const outputContent = output.querySelector('.p-3');
            const outputLabel = output.querySelector('.text-green-400');
            
            const results = {
                report: { label: 'Generated Report', title: 'Q3 Performance Summary', content: 'Revenue increased 23% YoY driven by successful product launch. Team capacity expanded to 12 members to support growth trajectory...' },
                summarize: { label: 'Summary Created', title: 'Key Points', content: ' 23% sales growth in Q3<br> New product launch exceeded targets<br> Team expanded from 8 to 12 members' },
                rewrite: { label: 'Rewritten (Formal)', title: 'Executive Summary', content: 'The third quarter demonstrated exceptional performance metrics, with revenue growth of 23% year-over-year. Strategic product initiatives...' },
                translate: { label: 'Translated (Spanish)', title: 'Resumen del Q3', content: 'Los ingresos aumentaron un 23% interanual impulsados por el exitoso lanzamiento del producto. La capacidad del equipo se expandi...' }
            };
            
            const r = results[action];
            outputLabel.innerHTML = `<i class="fa-solid fa-sparkles"></i> ${r.label}`;
            outputContent.innerHTML = `<div class="font-bold">${r.title}</div><div class="text-chim-light/70 text-xs mt-1">${r.content}</div>`;
            
            createParticles(btn);
        }

        function triggerExcelAction(action) {
            const btn = document.querySelector(`#demo-excel .office-action-btn[data-action="${action}"]`);
            const output = document.getElementById('excel-output');
            const outputLabel = document.getElementById('excel-output-label');
            const outputContent = document.getElementById('excel-output-content');
            
            if (officeActionStates.excel.has(action)) {
                officeActionStates.excel.delete(action);
                btn.classList.remove('triggered');
                if (officeActionStates.excel.size === 0) output.classList.add('hidden');
                return;
            }
            
            officeActionStates.excel.add(action);
            btn.classList.add('triggered');
            output.classList.remove('hidden');
            
            if (action === 'formula') {
                outputLabel.textContent = 'Formula Generated';
                outputContent.innerHTML = `<code class="text-xs bg-black/30 px-2 py-1 rounded">=SUMIF(B2:B4,">10000",C2:C4)</code><div class="text-xs text-chim-light/60 mt-2">Sum costs where sales exceed $10,000</div>`;
            } else if (action === 'chart') {
                outputLabel.textContent = 'Chart Created';
                outputContent.innerHTML = `
                    <div class="flex items-end gap-2 h-16">
                        <div class="flex-1 bg-blue-500/60 mini-bar rounded-t" style="height: 45%"></div>
                        <div class="flex-1 bg-blue-500/70 mini-bar rounded-t" style="height: 70%"></div>
                        <div class="flex-1 bg-blue-500/80 mini-bar rounded-t" style="height: 90%"></div>
                    </div>
                    <div class="flex justify-between text-[10px] text-chim-light/50 mt-1">
                        <span>Jan</span><span>Feb</span><span>Mar</span>
                    </div>`;
            } else if (action === 'insight') {
                outputLabel.textContent = 'Insights Found';
                outputContent.innerHTML = `<div class="text-xs space-y-1">
                    <div class="flex items-center gap-2"><i class="fa-solid fa-arrow-trend-up text-green-400"></i> Profit margin improving: 34%  43%</div>
                    <div class="flex items-center gap-2"><i class="fa-solid fa-lightbulb text-yellow-400"></i> March is your best month</div>
                    <div class="flex items-center gap-2"><i class="fa-solid fa-chart-line text-blue-400"></i> Projected Q2: $62,400 revenue</div>
                </div>`;
            } else if (action === 'clean') {
                outputLabel.textContent = 'Data Cleaned';
                outputContent.innerHTML = `<div class="text-xs space-y-1">
                    <div class="flex items-center gap-2"><i class="fa-solid fa-check text-green-400"></i> Removed 3 duplicate rows</div>
                    <div class="flex items-center gap-2"><i class="fa-solid fa-check text-green-400"></i> Fixed 2 formatting inconsistencies</div>
                    <div class="flex items-center gap-2"><i class="fa-solid fa-check text-green-400"></i> Standardized currency format</div>
                </div>`;
            }
            
            createParticles(btn);
        }

        function triggerPptAction(action) {
            const btn = document.querySelector(`#demo-powerpoint .office-action-btn[data-action="${action}"]`);
            const output = document.getElementById('ppt-output');
            const outputLabel = document.getElementById('ppt-output-label');
            const slidesContainer = document.getElementById('ppt-slides');
            
            if (officeActionStates.powerpoint.has(action)) {
                officeActionStates.powerpoint.delete(action);
                btn.classList.remove('triggered');
                if (officeActionStates.powerpoint.size === 0) {
                    output.classList.add('hidden');
                    slidesContainer.innerHTML = `<div class="aspect-video bg-chim-deep/50 rounded border border-chim-border/50 flex items-center justify-center text-chim-light/30 text-xs"><i class="fa-solid fa-plus"></i></div>`;
                }
                return;
            }
            
            officeActionStates.powerpoint.add(action);
            btn.classList.add('triggered');
            output.classList.remove('hidden');
            
            if (action === 'generate') {
                outputLabel.textContent = '5 Slides Generated';
                const slides = ['Intro', 'Market', 'Features', 'Timeline', 'Q&A'];
                const colors = ['bg-blue-500/30', 'bg-purple-500/30', 'bg-emerald-500/30', 'bg-orange-500/30', 'bg-pink-500/30'];
                slidesContainer.innerHTML = slides.map((s, i) => `
                    <div class="aspect-video ${colors[i]} rounded border border-chim-border/50 flex items-center justify-center text-chim-light text-[10px] font-bold slide-appear" style="animation-delay: ${i * 0.1}s">${s}</div>
                `).join('');
            } else if (action === 'design') {
                outputLabel.textContent = 'Design Applied';
                const existingSlides = slidesContainer.querySelectorAll('div');
                existingSlides.forEach(slide => {
                    slide.style.background = 'linear-gradient(135deg, #1e3a5f, #2d5a8a)';
                    slide.style.borderColor = '#5BA4E6';
                });
            } else if (action === 'notes') {
                outputLabel.textContent = 'Speaker Notes Added';
            } else if (action === 'image') {
                outputLabel.textContent = 'AI Images Added';
                const existingSlides = slidesContainer.querySelectorAll('div');
                existingSlides.forEach(slide => {
                    if (!slide.querySelector('i')) {
                        const icon = document.createElement('i');
                        icon.className = 'fa-solid fa-image ml-1 opacity-50';
                        slide.appendChild(icon);
                    }
                });
            }
            
            createParticles(btn);
        }

        function toggleMastery(el) {
            const id = el.dataset.index;
            if(masteredIds.has(id)) return;

            masteredIds.add(id);
            masteredCount++;
            
            el.classList.add('mastered', 'scale-105');
            const iconContainer = el.querySelector('.icon-container');
            iconContainer.classList.remove('bg-chim-deep/30', 'text-chim-light/50');
            iconContainer.classList.add('bg-blue-500/20', 'text-blue-300', 'border-blue-400/30');
            
            createParticles(el);
            
            document.getElementById('mastery-count').innerText = masteredCount;

            if(masteredCount === 3) {
                document.getElementById('success-message').classList.remove('hidden');
                setTimeout(() => {
                    for(let i=0; i<5; i++) {
                        setTimeout(() => createParticles(document.getElementById('success-message')), i * 200);
                    }
                }, 500);
            }
        }

        function createParticles(target) {
            const rect = target.getBoundingClientRect();
            const centerX = rect.left + rect.width / 2;
            const centerY = rect.top + rect.height / 2;

            for(let i=0; i<12; i++) {
                const p = document.createElement('div');
                p.className = 'particle';
                p.style.backgroundColor = ['#3B82F6', '#10B981', '#F59E0B', '#8B5CF6'][Math.floor(Math.random()*4)];
                p.style.left = (window.scrollX + centerX) + 'px';
                p.style.top = (window.scrollY + centerY) + 'px';
                
                const tx = (Math.random() - 0.5) * 200 + 'px';
                const ty = (Math.random() - 0.5) * 200 + 'px';
                p.style.setProperty('--tx', tx);
                p.style.setProperty('--ty', ty);

                document.body.appendChild(p);
                setTimeout(() => p.remove(), 1000);
            }
        }

        // --- 7. SIMULATOR LOGIC - EXPANDED ACTIONS ---
        const actionCategories = [
            {
                name: 'Layout',
                actions: [
                    { id: 'navbar', label: 'Navbar', icon: 'fa-bars', type: 'append' },
                    { id: 'hero', label: 'Hero Section', icon: 'fa-heading', type: 'append' },
                    { id: 'hero-img', label: 'Hero Image', icon: 'fa-image', type: 'modify', target: 'hero-section' },
                    { id: 'features', label: 'Features Grid', icon: 'fa-th-large', type: 'append' },
                    { id: 'two-col', label: 'Two Column', icon: 'fa-columns', type: 'append' },
                    { id: 'cta-banner', label: 'CTA Banner', icon: 'fa-bullhorn', type: 'append' },
                    { id: 'footer', label: 'Footer', icon: 'fa-shoe-prints', type: 'append' },
                ]
            },
            {
                name: 'Content',
                actions: [
                    { id: 'testimonials', label: 'Testimonials', icon: 'fa-comment-alt', type: 'append' },
                    { id: 'faq', label: 'FAQ Section', icon: 'fa-question-circle', type: 'append' },
                    { id: 'team', label: 'Team Grid', icon: 'fa-users', type: 'append' },
                    { id: 'stats', label: 'Stats Counter', icon: 'fa-chart-line', type: 'append' },
                    { id: 'timeline', label: 'Timeline', icon: 'fa-clock', type: 'append' },
                    { id: 'blog', label: 'Blog Grid', icon: 'fa-newspaper', type: 'append' },
                    { id: 'gallery', label: 'Image Gallery', icon: 'fa-images', type: 'append' },
                    { id: 'video', label: 'Video Embed', icon: 'fa-play-circle', type: 'append' },
                ]
            },
            {
                name: 'Commerce',
                actions: [
                    { id: 'pricing', label: 'Pricing Table', icon: 'fa-tag', type: 'append' },
                    { id: 'product-card', label: 'Product Card', icon: 'fa-box', type: 'append' },
                    { id: 'cart', label: 'Mini Cart', icon: 'fa-shopping-cart', type: 'overlay' },
                    { id: 'badges', label: 'Trust Badges', icon: 'fa-shield-alt', type: 'append' },
                    { id: 'countdown', label: 'Countdown', icon: 'fa-hourglass-half', type: 'append' },
                ]
            },
            {
                name: 'Forms',
                actions: [
                    { id: 'newsletter', label: 'Newsletter', icon: 'fa-envelope', type: 'append' },
                    { id: 'contact', label: 'Contact Form', icon: 'fa-paper-plane', type: 'append' },
                    { id: 'login', label: 'Login Modal', icon: 'fa-user-circle', type: 'modify', target: 'navbar' },
                    { id: 'search', label: 'Search Bar', icon: 'fa-search', type: 'modify', target: 'navbar' },
                    { id: 'survey', label: 'Survey Form', icon: 'fa-poll', type: 'append' },
                ]
            },
            {
                name: 'Widgets',
                actions: [
                    { id: 'chat', label: 'Chat Widget', icon: 'fa-comments', type: 'overlay' },
                    { id: 'social', label: 'Social Links', icon: 'fa-share-alt', type: 'append' },
                    { id: 'back-to-top', label: 'Back to Top', icon: 'fa-arrow-up', type: 'overlay' },
                    { id: 'cookie', label: 'Cookie Banner', icon: 'fa-cookie-bite', type: 'overlay' },
                    { id: 'notification', label: 'Notification', icon: 'fa-bell', type: 'overlay' },
                    { id: 'progress', label: 'Progress Bar', icon: 'fa-tasks', type: 'overlay' },
                ]
            },
            {
                name: 'Style',
                actions: [
                    { id: 'dark-mode', label: 'Dark Mode', icon: 'fa-moon', type: 'style', target: 'site-container', class: 'bg-gray-900 text-white' },
                    { id: 'rounded', label: 'Round Corners', icon: 'fa-circle-notch', type: 'style-global', class: 'rounded-2xl' },
                    { id: 'shadows', label: 'Add Shadows', icon: 'fa-cloud', type: 'style-global', class: 'shadow-xl' },
                    { id: 'animation', label: 'Animations', icon: 'fa-wand-magic-sparkles', type: 'style-global', class: 'animate-fade-in' },
                    { id: 'gradient-bg', label: 'Gradient BG', icon: 'fa-palette', type: 'style', target: 'site-container', class: 'bg-gradient-to-br from-gray-50 to-gray-100' },
                    { id: 'borders', label: 'Add Borders', icon: 'fa-border-all', type: 'style-global', class: 'border border-gray-200' },
                ]
            },
            {
                name: 'Advanced',
                actions: [
                    { id: 'parallax', label: 'Parallax', icon: 'fa-layer-group', type: 'style-global', class: 'parallax-effect' },
                    { id: 'glassmorphism', label: 'Glass Effect', icon: 'fa-wine-glass', type: 'style-global', class: 'glass-morphism' },
                    { id: 'skeleton', label: 'Skeleton Load', icon: 'fa-spinner', type: 'append' },
                    { id: 'tabs', label: 'Tab Component', icon: 'fa-folder', type: 'append' },
                    { id: 'accordion', label: 'Accordion', icon: 'fa-chevron-down', type: 'append' },
                    { id: 'carousel', label: 'Carousel', icon: 'fa-arrows-alt-h', type: 'append' },
                    { id: 'modal', label: 'Modal Popup', icon: 'fa-window-restore', type: 'overlay' },
                    { id: 'tooltip', label: 'Tooltips', icon: 'fa-info-circle', type: 'style-global', class: 'has-tooltip' },
                ]
            }
        ];

        let activeActions = new Set();
        let virtualAccent = '#3b82f6';
        const actionGrid = document.getElementById('action-grid');
        const siteContainer = document.getElementById('site-container');
        const statusLog = document.getElementById('status-log');
        const emptyState = document.getElementById('empty-state');
        const statusLight = document.getElementById('status-light');

        // Render categorized actions
        actionCategories.forEach(category => {
            const categoryLabel = document.createElement('div');
            categoryLabel.className = 'chip-category';
            categoryLabel.textContent = category.name;
            actionGrid.appendChild(categoryLabel);

            const grid = document.createElement('div');
            grid.className = 'grid grid-cols-2 gap-2 mb-2';
            
            category.actions.forEach(action => {
                const btn = document.createElement('button');
                btn.className = 'chip-btn text-left px-3 py-2 rounded-lg text-xs font-mono text-chim-light/60 flex items-center gap-2 select-none';
                btn.innerHTML = `<i class="fa-solid ${action.icon} w-4 text-center"></i> ${action.label}`;
                btn.onclick = () => toggleAction(action, btn);
                grid.appendChild(btn);
            });
            
            actionGrid.appendChild(grid);
        });

        // Theme Engine
        function changeAccentColor(color, swatch) {
            virtualAccent = color;
            document.querySelectorAll('.color-swatch').forEach(s => s.classList.remove('active'));
            swatch.classList.add('active');
            
            const buttons = siteContainer.querySelectorAll('.virtual-btn');
            buttons.forEach(b => {
                b.style.backgroundColor = virtualAccent;
                b.style.color = isLight(color) ? '#000' : '#fff';
            });
            
            const icons = siteContainer.querySelectorAll('.virtual-icon');
            icons.forEach(i => i.style.backgroundColor = virtualAccent);

            statusLog.innerText = `> Theme: ${color}`;
            statusLight.className = `w-2 h-2 rounded-full animate-pulse`;
            statusLight.style.backgroundColor = color;
        }

        // Toggle Logic
        function toggleAction(action, btnElement) {
            if (activeActions.has(action.id)) {
                removeComponent(action);
                activeActions.delete(action.id);
                btnElement.classList.remove('active');
                statusLog.innerText = `> Removed: ${action.label}`;
                statusLog.classList.add('text-red-400');
                statusLog.classList.remove('text-green-400', 'text-purple-400');
                
                if (activeActions.size === 0) emptyState.style.display = 'flex';
            } else {
                executeAction(action);
                activeActions.add(action.id);
                btnElement.classList.add('active');
                statusLog.innerText = `> Added: ${action.label}`;
                statusLog.classList.add('text-green-400');
                statusLog.classList.remove('text-red-400', 'text-purple-400');
                emptyState.style.display = 'none';
            }
        }

        function executeAction(action) {
            switch(action.type) {
                case 'append': appendComponent(action.id); break;
                case 'overlay': addOverlay(action.id); break;
                case 'style': 
                    document.getElementById(action.target)?.classList.add(...action.class.split(' ')); 
                    if(action.id === 'dark-mode') {
                        const nav = document.querySelector('#comp-navbar nav');
                        if(nav) { 
                            nav.classList.remove('bg-white', 'border-gray-200'); 
                            nav.classList.add('bg-gray-800', 'border-gray-700', 'text-white'); 
                        }
                    }
                    break;
                case 'style-global': applyGlobalStyle(action.class); break;
                case 'modify': modifyComponent(action.id, action.target, true); break;
            }
            
            if(action.type === 'append') {
                 setTimeout(() => {
                    const scroller = document.getElementById('scroll-container');
                    scroller.scrollTo({ top: scroller.scrollHeight, behavior: 'smooth' });
                 }, 50);
            }
        }

        function removeComponent(action) {
            if (action.type === 'append') {
                document.getElementById(`comp-${action.id}`)?.remove();
            } else if (action.type === 'overlay') {
                document.getElementById(`comp-${action.id}`)?.remove();
            } else if (action.type === 'style') {
                document.getElementById(action.target)?.classList.remove(...action.class.split(' '));
                if(action.id === 'dark-mode') {
                    const nav = document.querySelector('#comp-navbar nav');
                    if(nav) {
                        nav.classList.add('bg-white', 'border-gray-200');
                        nav.classList.remove('bg-gray-800', 'border-gray-700', 'text-white');
                    }
                }
            } else if (action.type === 'style-global') {
                removeGlobalStyle(action.class);
            } else if (action.type === 'modify') {
                modifyComponent(action.id, action.target, false);
            }
        }

        function appendComponent(id) {
            const div = document.createElement('div');
            div.id = `comp-${id}`;
            div.className = 'animate-pop';
            
            // Component order mapping - determines visual order regardless of when added
            const orderMap = {
                'navbar': 1,
                'hero': 2,
                'hero-img': 2, // Part of hero
                'stats': 10,
                'features': 20,
                'two-col': 30,
                'video': 35,
                'testimonials': 40,
                'team': 50,
                'timeline': 55,
                'gallery': 60,
                'blog': 70,
                'faq': 80,
                'pricing': 90,
                'product-card': 95,
                'cta-banner': 100,
                'badges': 105,
                'countdown': 110,
                'newsletter': 120,
                'contact': 130,
                'survey': 135,
                'social': 140,
                'skeleton': 145,
                'tabs': 150,
                'accordion': 155,
                'carousel': 160,
                'footer': 9999
            };
            
            // Set order
            div.style.order = orderMap[id] || 500;
            
            if (id === 'navbar') {
                div.innerHTML = `
                    <nav class="sticky top-0 bg-white shadow-sm border-b border-gray-200 p-4 flex justify-between items-center z-10">
                        <div class="font-bold text-lg" style="color:${virtualAccent}">Startup.io</div>
                        <div id="nav-links" class="flex items-center gap-4 text-sm text-gray-600">
                            <span class="cursor-pointer hover:text-gray-900 transition-colors">Product</span>
                            <span class="cursor-pointer hover:text-gray-900 transition-colors">Pricing</span>
                        </div>
                    </nav>`;
            }
            else if (id === 'hero') {
                div.innerHTML = `
                    <section id="hero-section" class="py-16 px-8 text-center">
                        <span class="inline-block px-3 py-1 text-xs rounded-full mb-4 text-white virtual-badge" style="background:${virtualAccent}">v2.0 Released</span>
                        <h1 class="text-3xl font-bold mb-3">Build faster than ever.</h1>
                        <p class="text-gray-500 text-sm mb-6 max-w-md mx-auto">The ultimate platform for creators who want to ship.</p>
                        <div class="flex gap-3 justify-center">
                            <button class="px-6 py-2 rounded-lg text-white font-bold text-sm virtual-btn hover:opacity-90 transition-opacity" style="background:${virtualAccent}">Get Started</button>
                            <button class="px-6 py-2 rounded-lg border border-gray-300 font-bold text-sm hover:bg-gray-50 transition-colors">Learn More</button>
                        </div>
                    </section>`;
            }
            else if (id === 'features') {
                const features = ['Fast Deploys', 'Auto-Scaling', 'Analytics', 'SSL Included'];
                div.innerHTML = `
                    <section class="py-12 px-8 grid grid-cols-2 gap-4">
                        ${features.map(f => `
                            <div class="p-4 border border-gray-200 rounded-lg hover:shadow-md transition-shadow">
                                <div class="w-8 h-8 rounded mb-3 flex items-center justify-center text-white virtual-icon" style="background:${virtualAccent}">
                                    <i class="fa-solid fa-check text-xs"></i>
                                </div>
                                <h4 class="font-bold text-sm">${f}</h4>
                            </div>
                        `).join('')}
                    </section>`;
            }
            else if (id === 'two-col') {
                div.innerHTML = `
                    <section class="py-12 px-8 grid grid-cols-2 gap-8 items-center">
                        <div class="aspect-video bg-gray-100 rounded-lg"></div>
                        <div>
                            <h3 class="text-xl font-bold mb-2">Why choose us?</h3>
                            <p class="text-gray-500 text-sm mb-4">We help you ship faster with less complexity.</p>
                            <button class="px-4 py-2 rounded text-white text-sm virtual-btn" style="background:${virtualAccent}">Learn More</button>
                        </div>
                    </section>`;
            }
            else if (id === 'cta-banner') {
                div.innerHTML = `
                    <section class="py-8 px-8 mx-4 my-8 rounded-lg text-white text-center" style="background:${virtualAccent}">
                        <h3 class="text-xl font-bold mb-2">Ready to get started?</h3>
                        <p class="text-sm opacity-80 mb-4">Join thousands of creators today.</p>
                        <button class="px-6 py-2 bg-white rounded font-bold text-sm" style="color:${virtualAccent}">Start Free</button>
                    </section>`;
            }
            else if (id === 'blog') {
                div.innerHTML = `
                    <section class="py-12 px-8">
                        <h3 class="font-bold mb-6 text-xl">Latest News</h3>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <div class="aspect-video bg-gray-200 rounded mb-2"></div>
                                <div class="text-sm font-bold">Launch Day</div>
                            </div>
                            <div>
                                <div class="aspect-video bg-gray-200 rounded mb-2"></div>
                                <div class="text-sm font-bold">New Features</div>
                            </div>
                        </div>
                    </section>`;
            }
            else if (id === 'newsletter') {
                div.innerHTML = `
                    <section class="py-12 px-8 mx-4 my-8 rounded-lg text-white text-center" style="background:${virtualAccent}">
                        <h3 class="text-xl font-bold mb-2">Stay updated</h3>
                        <p class="text-xs opacity-80 mb-4">No spam. Unsubscribe anytime.</p>
                        <div class="flex gap-2 max-w-xs mx-auto">
                            <input type="text" placeholder="you@email.com" class="px-3 py-2 rounded text-black text-xs w-full focus:outline-none">
                            <button class="bg-black/20 hover:bg-black/30 text-white px-4 py-2 rounded text-xs font-bold transition-colors">Go</button>
                        </div>
                    </section>`;
            }
            else if (id === 'footer') {
                div.innerHTML = `<footer class="p-8 text-center text-xs opacity-40 border-t border-gray-200 bg-gray-50">&copy; ${new Date().getFullYear()} Startup Inc.</footer>`;
            }
            else if (id === 'pricing') {
                div.innerHTML = `
                    <section class="py-12 px-8 grid grid-cols-2 gap-4">
                        <div class="p-4 border border-gray-200 rounded-lg text-center">
                            <div class="font-bold text-sm">Hobby</div>
                            <div class="text-2xl font-bold my-2">$0</div>
                            <button class="w-full py-1 bg-gray-200 text-black rounded text-xs">Start</button>
                        </div>
                        <div class="p-4 rounded-lg text-center text-white shadow-lg" style="background:${virtualAccent}">
                            <div class="font-bold text-sm">Pro</div>
                            <div class="text-2xl font-bold my-2">$29</div>
                            <button class="w-full py-1 bg-white rounded text-xs font-bold" style="color:${virtualAccent}">Upgrade</button>
                        </div>
                    </section>`;
            }
            else if (id === 'contact') {
                div.innerHTML = `
                    <section class="py-12 px-8 max-w-sm mx-auto">
                        <input class="w-full border border-gray-200 rounded p-2 mb-2 bg-transparent text-sm" placeholder="Name">
                        <textarea class="w-full border border-gray-200 rounded p-2 mb-2 bg-transparent text-sm" rows="3" placeholder="Message"></textarea>
                        <button class="w-full py-2 rounded text-white font-bold text-sm virtual-btn" style="background:${virtualAccent}">Send</button>
                    </section>`;
            }
            else if (id === 'testimonials') {
                div.innerHTML = `
                    <section class="py-12 px-8">
                        <div class="p-4 border-l-4 bg-gray-50" style="border-color:${virtualAccent}">
                            <p class="italic text-sm text-gray-600">"Saved me 100+ hours."</p>
                            <div class="font-bold text-xs mt-2"> Sarah J.</div>
                        </div>
                    </section>`;
            }
            else if (id === 'faq') {
                div.innerHTML = `
                    <section class="py-12 px-8">
                        <h3 class="font-bold mb-6 text-xl">FAQ</h3>
                        <div class="space-y-3">
                            <div class="p-3 border border-gray-200 rounded">
                                <div class="font-bold text-sm">How do I get started?</div>
                                <div class="text-xs text-gray-500 mt-1">Sign up and follow the onboarding flow.</div>
                            </div>
                            <div class="p-3 border border-gray-200 rounded">
                                <div class="font-bold text-sm">Is there a free tier?</div>
                                <div class="text-xs text-gray-500 mt-1">Yes, you can start for free forever.</div>
                            </div>
                        </div>
                    </section>`;
            }
            else if (id === 'team') {
                div.innerHTML = `
                    <section class="py-12 px-8">
                        <h3 class="font-bold mb-6 text-xl">Our Team</h3>
                        <div class="grid grid-cols-3 gap-4 text-center">
                            <div><div class="w-12 h-12 rounded-full bg-gray-200 mx-auto mb-2"></div><div class="text-xs font-bold">Alice</div></div>
                            <div><div class="w-12 h-12 rounded-full bg-gray-200 mx-auto mb-2"></div><div class="text-xs font-bold">Bob</div></div>
                            <div><div class="w-12 h-12 rounded-full bg-gray-200 mx-auto mb-2"></div><div class="text-xs font-bold">Carol</div></div>
                        </div>
                    </section>`;
            }
            else if (id === 'stats') {
                div.innerHTML = `
                    <section class="py-12 px-8 grid grid-cols-3 gap-4 text-center">
                        <div><div class="text-3xl font-bold" style="color:${virtualAccent}">10K+</div><div class="text-xs text-gray-500">Users</div></div>
                        <div><div class="text-3xl font-bold" style="color:${virtualAccent}">99%</div><div class="text-xs text-gray-500">Uptime</div></div>
                        <div><div class="text-3xl font-bold" style="color:${virtualAccent}">24/7</div><div class="text-xs text-gray-500">Support</div></div>
                    </section>`;
            }
            else if (id === 'timeline') {
                div.innerHTML = `
                    <section class="py-12 px-8">
                        <h3 class="font-bold mb-6 text-xl">Roadmap</h3>
                        <div class="space-y-4 border-l-2 pl-4" style="border-color:${virtualAccent}">
                            <div><div class="text-xs text-gray-400">Q1</div><div class="font-bold text-sm">Beta Launch</div></div>
                            <div><div class="text-xs text-gray-400">Q2</div><div class="font-bold text-sm">Public Release</div></div>
                            <div><div class="text-xs text-gray-400">Q3</div><div class="font-bold text-sm">Enterprise Tier</div></div>
                        </div>
                    </section>`;
            }
            else if (id === 'gallery') {
                div.innerHTML = `
                    <section class="py-12 px-8">
                        <h3 class="font-bold mb-6 text-xl">Gallery</h3>
                        <div class="grid grid-cols-3 gap-2">
                            <div class="aspect-square bg-gray-200 rounded"></div>
                            <div class="aspect-square bg-gray-200 rounded"></div>
                            <div class="aspect-square bg-gray-200 rounded"></div>
                        </div>
                    </section>`;
            }
            else if (id === 'video') {
                div.innerHTML = `
                    <section class="py-12 px-8">
                        <div class="aspect-video bg-gray-900 rounded-lg flex items-center justify-center">
                            <div class="w-16 h-16 rounded-full flex items-center justify-center text-white cursor-pointer hover:scale-110 transition-transform" style="background:${virtualAccent}">
                                <i class="fa-solid fa-play ml-1"></i>
                            </div>
                        </div>
                    </section>`;
            }
            else if (id === 'product-card') {
                div.innerHTML = `
                    <section class="py-12 px-8">
                        <div class="border border-gray-200 rounded-lg p-4 max-w-xs mx-auto">
                            <div class="aspect-square bg-gray-100 rounded mb-4"></div>
                            <h4 class="font-bold">Product Name</h4>
                            <p class="text-sm text-gray-500 mb-2">Short description here</p>
                            <div class="flex justify-between items-center">
                                <span class="font-bold" style="color:${virtualAccent}">$49</span>
                                <button class="px-3 py-1 rounded text-white text-xs virtual-btn" style="background:${virtualAccent}">Add to Cart</button>
                            </div>
                        </div>
                    </section>`;
            }
            else if (id === 'badges') {
                div.innerHTML = `
                    <section class="py-8 px-8 flex justify-center gap-6 opacity-50">
                        <i class="fa-solid fa-lock text-2xl"></i>
                        <i class="fa-solid fa-shield-halved text-2xl"></i>
                        <i class="fa-brands fa-cc-visa text-2xl"></i>
                        <i class="fa-brands fa-cc-mastercard text-2xl"></i>
                    </section>`;
            }
            else if (id === 'countdown') {
                div.innerHTML = `
                    <section class="py-8 px-8 text-center">
                        <p class="text-sm text-gray-500 mb-2">Offer ends in</p>
                        <div class="flex justify-center gap-4">
                            <div><span class="text-3xl font-bold" style="color:${virtualAccent}">02</span><div class="text-xs">Days</div></div>
                            <div><span class="text-3xl font-bold" style="color:${virtualAccent}">14</span><div class="text-xs">Hours</div></div>
                            <div><span class="text-3xl font-bold" style="color:${virtualAccent}">32</span><div class="text-xs">Mins</div></div>
                        </div>
                    </section>`;
            }
            else if (id === 'social') {
                div.innerHTML = `
                    <section class="py-8 px-8 flex justify-center gap-4">
                        <a class="w-10 h-10 rounded-full flex items-center justify-center text-white hover:opacity-80 transition-opacity" style="background:${virtualAccent}"><i class="fa-brands fa-twitter"></i></a>
                        <a class="w-10 h-10 rounded-full flex items-center justify-center text-white hover:opacity-80 transition-opacity" style="background:${virtualAccent}"><i class="fa-brands fa-linkedin"></i></a>
                        <a class="w-10 h-10 rounded-full flex items-center justify-center text-white hover:opacity-80 transition-opacity" style="background:${virtualAccent}"><i class="fa-brands fa-github"></i></a>
                    </section>`;
            }
            else if (id === 'survey') {
                div.innerHTML = `
                    <section class="py-12 px-8 max-w-sm mx-auto">
                        <h3 class="font-bold mb-4 text-lg">Quick Survey</h3>
                        <div class="space-y-2 mb-4">
                            <label class="flex items-center gap-2 text-sm"><input type="radio" name="survey"> Option A</label>
                            <label class="flex items-center gap-2 text-sm"><input type="radio" name="survey"> Option B</label>
                            <label class="flex items-center gap-2 text-sm"><input type="radio" name="survey"> Option C</label>
                        </div>
                        <button class="w-full py-2 rounded text-white font-bold text-sm virtual-btn" style="background:${virtualAccent}">Submit</button>
                    </section>`;
            }
            else if (id === 'skeleton') {
                div.innerHTML = `
                    <section class="py-12 px-8 space-y-4">
                        <div class="h-4 bg-gray-200 rounded animate-pulse w-3/4"></div>
                        <div class="h-4 bg-gray-200 rounded animate-pulse w-1/2"></div>
                        <div class="h-24 bg-gray-200 rounded animate-pulse"></div>
                        <div class="h-4 bg-gray-200 rounded animate-pulse w-2/3"></div>
                    </section>`;
            }
            else if (id === 'tabs') {
                div.innerHTML = `
                    <section class="py-12 px-8">
                        <div class="flex border-b border-gray-200 mb-4">
                            <button class="px-4 py-2 text-sm font-bold border-b-2" style="border-color:${virtualAccent}; color:${virtualAccent}">Tab 1</button>
                            <button class="px-4 py-2 text-sm text-gray-400">Tab 2</button>
                            <button class="px-4 py-2 text-sm text-gray-400">Tab 3</button>
                        </div>
                        <div class="p-4 bg-gray-50 rounded">Tab content goes here...</div>
                    </section>`;
            }
            else if (id === 'accordion') {
                div.innerHTML = `
                    <section class="py-12 px-8 space-y-2">
                        <div class="border border-gray-200 rounded">
                            <div class="p-3 font-bold text-sm flex justify-between items-center cursor-pointer">Item 1 <i class="fa-solid fa-chevron-down text-xs"></i></div>
                            <div class="p-3 text-sm text-gray-500 border-t border-gray-200">Content for item 1</div>
                        </div>
                        <div class="border border-gray-200 rounded">
                            <div class="p-3 font-bold text-sm flex justify-between items-center cursor-pointer">Item 2 <i class="fa-solid fa-chevron-down text-xs"></i></div>
                        </div>
                    </section>`;
            }
            else if (id === 'carousel') {
                div.innerHTML = `
                    <section class="py-12 px-8">
                        <div class="flex items-center gap-4">
                            <button class="w-8 h-8 rounded-full border border-gray-300 flex items-center justify-center hover:bg-gray-100"><i class="fa-solid fa-chevron-left text-xs"></i></button>
                            <div class="flex-1 aspect-video bg-gray-200 rounded-lg"></div>
                            <button class="w-8 h-8 rounded-full border border-gray-300 flex items-center justify-center hover:bg-gray-100"><i class="fa-solid fa-chevron-right text-xs"></i></button>
                        </div>
                        <div class="flex justify-center gap-2 mt-4">
                            <div class="w-2 h-2 rounded-full" style="background:${virtualAccent}"></div>
                            <div class="w-2 h-2 rounded-full bg-gray-300"></div>
                            <div class="w-2 h-2 rounded-full bg-gray-300"></div>
                        </div>
                    </section>`;
            }

            siteContainer.appendChild(div);
            reapplyGlobalStyles(div);
        }

        function addOverlay(id) {
            const overlayContainer = document.getElementById('overlay-container');
            
            if (id === 'chat') {
                const div = document.createElement('div');
                div.id = 'comp-chat';
                div.className = 'absolute bottom-4 right-4 w-12 h-12 rounded-full flex items-center justify-center text-white shadow-lg cursor-pointer hover:scale-110 transition-transform animate-pop pointer-events-auto';
                div.style.backgroundColor = virtualAccent;
                div.innerHTML = '<i class="fa-solid fa-comment-dots"></i>';
                overlayContainer.appendChild(div);
            }
            else if (id === 'cart') {
                const div = document.createElement('div');
                div.id = 'comp-cart';
                div.className = 'absolute top-4 right-4 bg-white shadow-xl rounded-lg p-4 w-48 animate-pop border border-gray-200 pointer-events-auto';
                div.innerHTML = `
                    <div class="font-bold text-sm mb-2">Cart (2)</div>
                    <div class="text-xs text-gray-500 mb-3">2 items  $78</div>
                    <button class="w-full py-2 rounded text-white text-xs font-bold" style="background:${virtualAccent}">Checkout</button>
                `;
                overlayContainer.appendChild(div);
            }
            else if (id === 'back-to-top') {
                const div = document.createElement('div');
                div.id = 'comp-back-to-top';
                div.className = 'absolute bottom-4 left-4 w-10 h-10 rounded-full flex items-center justify-center text-white shadow-lg cursor-pointer hover:scale-110 transition-transform animate-pop pointer-events-auto';
                div.style.backgroundColor = virtualAccent;
                div.innerHTML = '<i class="fa-solid fa-arrow-up text-sm"></i>';
                overlayContainer.appendChild(div);
            }
            else if (id === 'cookie') {
                const div = document.createElement('div');
                div.id = 'comp-cookie';
                div.className = 'absolute bottom-0 left-0 right-0 bg-gray-900 text-white p-4 flex justify-between items-center animate-pop pointer-events-auto';
                div.innerHTML = `
                    <span class="text-xs">We use cookies </span>
                    <button class="px-3 py-1 rounded text-xs font-bold" style="background:${virtualAccent}">Accept</button>
                `;
                overlayContainer.appendChild(div);
            }
            else if (id === 'notification') {
                const div = document.createElement('div');
                div.id = 'comp-notification';
                div.className = 'absolute top-4 right-4 bg-white shadow-xl rounded-lg p-3 w-56 animate-pop border-l-4 pointer-events-auto';
                div.style.borderColor = virtualAccent;
                div.innerHTML = `
                    <div class="font-bold text-sm">New Message</div>
                    <div class="text-xs text-gray-500">You have 3 unread notifications</div>
                `;
                overlayContainer.appendChild(div);
            }
            else if (id === 'progress') {
                const div = document.createElement('div');
                div.id = 'comp-progress';
                div.className = 'absolute top-0 left-0 right-0 h-1 animate-pop';
                div.style.background = `linear-gradient(to right, ${virtualAccent} 60%, #e5e7eb 60%)`;
                overlayContainer.appendChild(div);
            }
            else if (id === 'modal') {
                const div = document.createElement('div');
                div.id = 'comp-modal';
                div.className = 'absolute inset-0 bg-black/50 flex items-center justify-center animate-pop pointer-events-auto';
                div.innerHTML = `
                    <div class="bg-white rounded-lg p-6 w-64 text-center">
                        <h3 class="font-bold mb-2">Welcome!</h3>
                        <p class="text-sm text-gray-500 mb-4">Sign up for updates</p>
                        <button class="w-full py-2 rounded text-white font-bold text-sm" style="background:${virtualAccent}">Subscribe</button>
                    </div>
                `;
                overlayContainer.appendChild(div);
            }
        }

        function modifyComponent(id, targetId, add) {
            if (id === 'hero-img') {
                const section = document.querySelector('#comp-hero #hero-section');
                if(!section) return;
                
                if (add) {
                    const img = document.createElement('div');
                    img.id = 'added-hero-img';
                    img.className = 'mt-8 h-40 w-full rounded-lg animate-pop bg-cover bg-center opacity-90';
                    img.style.backgroundImage = `url('https://images.unsplash.com/photo-1460925895917-afdab827c52f?w=800&h=400&fit=crop')`;
                    img.style.backgroundColor = '#e2e8f0';
                    section.appendChild(img);
                    if(activeActions.has('rounded')) img.classList.add('rounded-2xl');
                } else {
                    document.getElementById('added-hero-img')?.remove();
                }
            } 
            else if (id === 'login') {
                const nav = document.querySelector('#comp-navbar nav');
                if(!nav) return;
                
                if(add) {
                    const btn = document.createElement('div');
                    btn.id = 'added-login-btn';
                    btn.className = 'w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center text-gray-600 text-xs ml-4 animate-pop cursor-pointer';
                    btn.innerHTML = '<i class="fa-solid fa-user"></i>';
                    nav.querySelector('#nav-links').appendChild(btn);
                } else {
                    document.getElementById('added-login-btn')?.remove();
                }
            }
            else if (id === 'search') {
                const nav = document.querySelector('#comp-navbar nav');
                if(!nav) return;
                
                if(add) {
                    const search = document.createElement('div');
                    search.id = 'added-search';
                    search.className = 'flex items-center gap-2 px-3 py-1 rounded border border-gray-200 text-gray-400 text-xs ml-4 animate-pop';
                    search.innerHTML = '<i class="fa-solid fa-search"></i> Search...';
                    nav.querySelector('#nav-links').appendChild(search);
                } else {
                    document.getElementById('added-search')?.remove();
                }
            }
        }

        function applyGlobalStyle(className) {
            const elements = siteContainer.querySelectorAll('div, section, nav, button, input, .virtual-icon, img');
            elements.forEach(el => {
                if(shouldApplyStyle(el, className)) el.classList.add(...className.split(' '));
            });
        }

        function removeGlobalStyle(className) {
            const elements = siteContainer.querySelectorAll('*');
            elements.forEach(el => {
                el.classList.remove(...className.split(' '));
            });
        }

        function reapplyGlobalStyles(container) {
            if (activeActions.has('rounded')) {
                const els = container.querySelectorAll('div, section, nav, button, input');
                els.forEach(el => { if(shouldApplyStyle(el, 'rounded')) el.classList.add('rounded-2xl'); });
            }
            if (activeActions.has('shadows')) {
                const els = container.querySelectorAll('div, nav, button');
                els.forEach(el => { if(shouldApplyStyle(el, 'shadow')) el.classList.add('shadow-xl'); });
            }
            if (activeActions.has('borders')) {
                const els = container.querySelectorAll('div, section');
                els.forEach(el => { if(shouldApplyStyle(el, 'border')) el.classList.add('border', 'border-gray-200'); });
            }
        }

        function shouldApplyStyle(el, type) {
            const tag = el.tagName;
            const hasBorder = el.classList.contains('border');
            if (type.includes('rounded')) {
                return (tag === 'SECTION' || tag === 'NAV' || tag === 'BUTTON' || tag === 'INPUT' || hasBorder || el.classList.contains('virtual-icon'));
            }
            if (type.includes('shadow')) {
                return (tag === 'NAV' || tag === 'BUTTON' || hasBorder);
            }
            if (type.includes('border')) {
                return (tag === 'SECTION' && !hasBorder);
            }
            return false;
        }

        function isLight(color) {
            return color === '#f59e0b' || color === '#34d399' || color === '#fbbf24'; 
        }

        function resetDemo() {
            siteContainer.innerHTML = '';
            // Clear overlay container
            document.getElementById('overlay-container').innerHTML = '';
            emptyState.style.display = 'flex';
            activeActions.clear();
            document.querySelectorAll('.chip-btn').forEach(btn => btn.classList.remove('active'));
            statusLog.innerText = 'Reset complete.';
            statusLog.className = 'text-xs font-mono text-gray-500 h-6 overflow-hidden truncate';
            siteContainer.className = 'min-h-full flex flex-col transition-all duration-300 text-gray-800';
        }
    </script>
</body>
</html>
